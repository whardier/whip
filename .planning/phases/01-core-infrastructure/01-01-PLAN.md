---
phase: 01-core-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - src/whip/__init__.py
  - src/whip/main.py
  - static/index.html
autonomous: true

must_haves:
  truths:
    - "FastAPI server starts and binds to 0.0.0.0:9447"
    - "Browser can connect and load HTML page from server"
  artifacts:
    - path: "pyproject.toml"
      provides: "Project configuration with FastAPI, uvicorn dependencies"
      contains: "fastapi"
    - path: "src/whip/main.py"
      provides: "FastAPI application with static file serving"
      contains: "FastAPI"
    - path: "static/index.html"
      provides: "Test HTML page for browser connection"
      min_lines: 10
  key_links:
    - from: "src/whip/main.py"
      to: "static/"
      via: "StaticFiles mount"
      pattern: "StaticFiles.*directory"
---

<objective>
Set up Python project structure and FastAPI server that serves static files on port 9447.

Purpose: Establish the foundation for all subsequent phases - a working web server that browsers can connect to.
Output: Running FastAPI server accessible at http://0.0.0.0:9447 with static HTML page.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/research/fastapi-websocket.md (sections 1, 7)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Python project with uv and dependencies</name>
  <files>pyproject.toml, src/whip/__init__.py</files>
  <action>
Create Python project structure using uv:

1. Initialize project with `uv init` if pyproject.toml doesn't exist
2. Create/update pyproject.toml with:
   - name: "whip"
   - python version: ">=3.12"
   - dependencies using ~= for patch version compatibility:
     - fastapi~=0.115.0
     - uvicorn[standard]~=0.34.0
   - dev dependencies:
     - ruff~=0.9.0
     - pyright~=1.1.0
   - ruff configuration: line-length = 120
   - pyright configuration: basic type checking

3. Create src/whip/__init__.py (empty, marks package)

4. Run `uv sync` to install dependencies

Per user decision: Use uv for package management, ruff/pyright for linting, 120 char line length, ~= for version pinning.
  </action>
  <verify>
- `uv run python -c "import fastapi; print(fastapi.__version__)"` succeeds
- `uv run ruff --version` succeeds
- pyproject.toml exists with correct dependencies
  </verify>
  <done>
Python project initialized with FastAPI and uvicorn installed, linting tools configured.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create FastAPI server with static file serving</name>
  <files>src/whip/main.py, static/index.html</files>
  <action>
Create FastAPI application serving static files:

1. Create src/whip/main.py:
   - Import FastAPI, StaticFiles from fastapi.staticfiles
   - Create FastAPI app instance
   - Mount static files: `app.mount("/static", StaticFiles(directory="static"), name="static")`
   - Add root GET endpoint that redirects to /static/index.html or serves it directly
   - Add startup event that logs: "WHIP server running at http://0.0.0.0:9447"
   - Configure for running with uvicorn: host="0.0.0.0", port=9447

2. Create static/index.html:
   - Basic HTML5 document
   - Title: "WHIP - Web Host Input Protocol"
   - Simple content showing "WHIP Control Interface"
   - Placeholder div for connection status (will be used in Plan 02)
   - No CSS/JS yet - just verify static serving works

3. Add __main__.py or run configuration so `uv run python -m whip` starts server

Per user decision: Port 9447 (WHIP on phone keypad), bind to 0.0.0.0 for local network access.
  </action>
  <verify>
- `uv run uvicorn whip.main:app --host 0.0.0.0 --port 9447` starts without errors
- `curl http://localhost:9447/static/index.html` returns HTML content
- Browser can load http://localhost:9447/static/index.html
  </verify>
  <done>
FastAPI server starts on port 9447, serves static HTML page, accessible from browser.
  </done>
</task>

</tasks>

<verification>
1. Server starts: `uv run uvicorn whip.main:app --host 0.0.0.0 --port 9447`
2. Static file accessible: `curl -s http://localhost:9447/static/index.html | grep -q "WHIP"`
3. No import errors or warnings in server output
</verification>

<success_criteria>
- FastAPI server runs on 0.0.0.0:9447
- Static HTML page loads in browser
- Project structure follows Python best practices
- Dependencies installed and working
</success_criteria>

<output>
After completion, create `.planning/phases/01-core-infrastructure/01-01-SUMMARY.md`
</output>
